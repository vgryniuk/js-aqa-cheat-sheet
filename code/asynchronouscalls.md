# Asynchronous calls
---

Асинхронні запити в JavaScript використовуються для виконання операцій, які не блокують виконання інших операцій у програмі. Основна відмінність асинхронних операцій полягає у тому, що код може продовжувати виконання, навіть якщо асинхронна операція ще не завершилася, тобто виконання не зупиняється, чекаючи результат виконання асинхронної операції. У JavaScript асинхронні запити широко використовуються для виконання операцій, таких як отримання даних з сервера (запити AJAX), читання файлів, взаємодія з базами даних, запуск таймерів тощо.

Основні механізми для роботи з асинхронними операціями включають:

* **Callbacks (зворотні виклики)**: Це функції, які передаються як параметри та викликаються після завершення асинхронної операції для обробки результатів.
* **Promises (обіцянки)**: Об'єкти, які представляють результат асинхронної операції, яка може бути виконана або відхилена у майбутньому.
* **Async/await**: Синтаксичний цукор для роботи з промісами, який дозволяє писати асинхронний код у більш синхронному стилі.

### Callback
---

**Callback** - це функція, яка передається іншій функції як аргумент і викликається пізніше після завершення певної операції або події. Вони дозволяють створювати асинхронний код і виконувати дії після завершення певних операцій без блокування виконання програми.

Існує кілька типів callback-функцій:

* **Синхронні callback:** Вони викликаються одразу, без затримки, якщо викликаюча функція є синхронною.
* **Асинхронні callback:** Вони викликаються після завершення асинхронних операцій, таких як завантаження файлів, введення користувача або мережеві запити.
* **Named callback:** Це функції, які мають ім'я, що може полегшити читання коду та його розуміння.
* **Anonymous callback:** Це функції без імені, які передаються безпосередньо як аргумент.

Краще застосовувати `callback` у випадках асинхронного коду, такого як обробка результатів запитів до баз даних, робота з файлами, обробка подій веб-додатків тощо. Вони корисні для здійснення дій після завершення певних операцій та уникнення блокування інших частин програми.

Однак із застосуванням callback можуть виникнути певні проблеми:
* **Callback Hell (пекло callback):** Це ситуація, коли занадто багато вкладених callback-функцій роблять код важким для розуміння та обслуговування.
* **Проблеми з областю видимості (Scope Issues):** Змінні, які зовнішні для callback-функцій, можуть не бути доступні в контексті цих функцій.
* **Помилки управління (Error handling issues):** Некоректне управління помилками може призвести до складнощів у відлагодженні та виконанні коду.

Для рішення деяких з цих проблем використовуються нові концепції, такі як `Promise` та `async/await`, які забезпечують кращий контроль над асинхронним кодом та полегшують його читання та обслуговування.

```
const numbers = [1, 2, 3, 4, 5];

// Функція, яка буде використовуватися як колбек
function printElement(element) {
    console.log(element);
}

function processArray(arr, callback) {
    for (let i = 0; i < arr.length; i++) {
        // Виклик колбеку для кожного елемента масиву
        callback(arr[i]);
    }
}
    
// Виклик функції processArray з використанням явного колбеку
processArray(numbers, printElement);
```

```
// Приклад анонімного колбека для методу map()
const numbers = [1, 2, 3, 4, 5];

const doubledNumbers = numbers.map(function(number) {
  return number * 2;
});

console.log(doubledNumbers); // Результат: [2, 4, 6, 8, 10]
```
### Promise
---
У JavaScript **Promise** - це об'єкт, який представляє результат асинхронної операції, яка може бути виконана або відхилена у майбутньому. Promise дозволяє управляти асинхронним кодом більш структуровано, дозволяючи визначити поведінку після завершення операції.
Структура Promise:

![Promise state diagram](/pics/promise.png "Promise state diagram")
Promise має наступні стани:
* **Pending (очікування):** Початковий стан, коли проміс не виконався і не відхилений.
* **Fulfilled (виконано):** Стан, коли асинхронна операція завершилася успішно.
* **Rejected (відхилено):** Стан, коли асинхронна операція завершилася з помилкою.

![Promise methods diagram](/pics/promise2.png "Promise methods diagram")
Методи Promise:
* **`then()`:** Викликається після того, як проміс виконається або відхилиться. Приймає два аргументи: функцію, яка виконується при успішному виконанні (fulfilled), і функцію, яка виконується при відхиленні (rejected).
* **`catch()`:** Викликається тільки у випадку відхилення проміса. Використовується для обробки помилок, що виникають під час виконання проміса.
* **`finally()`**: Викликається завжди, незалежно від того, чи виконано проміс, чи він відхилений. Використовується для виконання певних дій після завершення проміса.
```
// Приклад Promise для виконання через певний час
let myPromise = new Promise((resolve, reject) => {
  setTimeout(() => {
    let randomNum = Math.random();
    if (randomNum < 0.5) {
      resolve(randomNum); // Успішне виконання
    } else {
      reject("Error!"); // Відхилення з помилкою
    }
  }, 2000);
});

// Використання then() та catch() для обробки результатів асинхронної операції
myPromise.then((result) => {
  console.log("Успіх! Результат:", result);
}).catch((error) => {
  console.log("Помилка:", error);
});
```
---
